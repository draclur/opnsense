<model>
    <mount>//OPNsense/Netflow</mount>
    <version>1.0.1</version>
    <description>
        OPNsense Netflow
    </description>
    <items>
        <capture>
            <interfaces type="InterfaceField">
                <Required>N</Required>
                <default></default>
                <multiple>Y</multiple>
                <filters>
                    <enable>/^(?!0).*$/</enable>
                </filters>
            </interfaces>
            <egress_only type="InterfaceField">
                <Required>N</Required>
                <default></default>
                <multiple>Y</multiple>
                <filters>
                    <enable>/^(?!0).*$/</enable>
                </filters>
            </egress_only>
            <version type="OptionField">
                <Required>Y</Required>
                <default>v9</default>
                <OptionValues>
                    <v5>v5</v5>
                    <v9>v9</v9>
                </OptionValues>
            </version>
            <targets type="CSVListField">
                <Required>N</Required>
                <mask>/^((?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?):(6553[0-5]|655[0-2][0-9]|65[0-4](\d){2}|6[0-4](\d){3}|[1-5](\d){4}|[1-9](\d){0,3})([,]){0,1})*/u</mask>
                <ValidationMessage>Please enter valid targets (e.g. 192.168.0.1:2055).</ValidationMessage>
            </targets>
        </capture>
        <collect>
            <enable type="BooleanField">
                <default>0</default>
                <Required>Y</Required>
            </enable>
            <history>
                <FlowInterfaceTotals>
                    <_30 type="IntegerField">
                        <default>86400</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_30>
                    <_300 type="IntegerField">
                        <default>604800</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_300>
                    <_3600 type="IntegerField">
                        <default>2678400</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_3600>
                    <_86400 type="IntegerField">
                        <default>31536000</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_86400>
                </FlowInterfaceTotals>
                <FlowDstPortTotals>
                    <_300 type="IntegerField">
                        <default>3600</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_300>
                    <_3600 type="IntegerField">
                        <default>86400</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_3600>
                    <_86400 type="IntegerField">
                        <default>31536000</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_86400>
                </FlowDstPortTotals>
                <FlowSourceAddrTotals>
                    <_300 type="IntegerField">
                        <default>3600</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_300>
                    <_3600 type="IntegerField">
                        <default>86400</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_3600>
                    <_86400 type="IntegerField">
                        <default>31536000</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_86400>
                </FlowSourceAddrTotals>
                <FlowSourceAddrDetails>
                    <_86400 type="IntegerField">
                        <default>5356800</default>
                        <Required>Y</Required>
                        <MinimumValue>0</MinimumValue>
                        <ValidationMessage>Must be an integer value greater than zero.</ValidationMessage>
                    </_86400>
                </FlowSourceAddrDetails>
            </history>
        </collect>
        <activeTimeout type="IntegerField">
            <default>1800</default>
            <Required>Y</Required>
            <MinimumValue>1</MinimumValue>
            <MaximumValue>86400</MaximumValue>
            <ValidationMessage>Active timeout needs to be an integer value between 1 and 86400</ValidationMessage>
         </activeTimeout>
         <inactiveTimeout type="IntegerField">
            <default>15</default>
            <Required>Y</Required>
            <MinimumValue>1</MinimumValue>
            <MaximumValue>86400</MaximumValue>
            <ValidationMessage>Inactive timeout needs to be an integer value between 1 and 86400</ValidationMessage>
         </inactiveTimeout>
    </items>
</model>
